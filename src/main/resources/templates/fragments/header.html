<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="header">
  <head>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
  </head>

  <body>
    <div
      class="p-4 w-full border-b border-primary-mid flex items-center justify-between"
    >
      <div class="flex items-center gap-2">
        <span th:replace="fragments/json-icon :: jsonIcon(size=28)"></span>

        <span class="text-lg font-semibold tracking-wide">
          JSONBin Config Manager
        </span>
      </div>

      <div class="flex gap-4">
        <a
          th:href="@{/user}"
          class="flex items-center justify-center rounded-full h-12 w-12 bg-primary-light text-primary-dark hover:bg-primary-mid hover:text-primary-base transition-colors focus:outline-none focus:ring-2 focus:ring-primary-mid focus:ring-offset-2 active:scale-95"
          title="User Management"
          aria-label="User Management"
        >
          <span class="material-symbols-outlined text-primary-dark"
            >manage_accounts</span
          >
        </a>

        <div class="relative">
          <button
            class="h-12 w-12 rounded-full flex items-center justify-center bg-primary-dark text-white text-lg font-semibold"
            onclick="toggleMenu()"
          >
            <span
              th:text="${#authentication.principal?.username != null ? #strings.substring(#authentication.principal.username, 0, 1).toUpperCase() : 'U'}"
            ></span>
          </button>

          <div
            id="main-menu"
            class="absolute right-0 mt-2 w-48 bg-primary-light shadow-lg rounded-lg border border-primary-light hidden z-50"
          >
            <ul class="py-2">
              <li>
                <a
                  th:href="@{/dashboard}"
                  class="flex items-center gap-3 w-full px-4 py-2 text-primary-dark hover:bg-primary-dark hover:text-white transition-colors group"
                >
                  <span
                    class="material-symbols-outlined text-primary-dark group-hover:text-white transition-colors text-[20px]"
                    >dashboard</span
                  >
                  Dashboard
                </a>
              </li>

              <li>
                <a
                  th:href="@{/account}"
                  class="flex items-center gap-3 w-full px-4 py-2 text-primary-dark hover:bg-primary-dark hover:text-white transition-colors group"
                >
                  <span
                    class="material-symbols-outlined text-primary-dark group-hover:text-white transition-colors text-[20px]"
                    >person</span
                  >
                  Account
                </a>
              </li>

              <li>
                <form th:action="@{/logout}" method="post" class="w-full">
                  <button
                    type="submit"
                    class="flex items-center gap-3 w-full px-4 py-2 text-primary-dark hover:bg-red-bg hover:text-red-text transition-colors group"
                  >
                    <span
                      class="material-symbols-outlined text-primary-dark group-hover:text-red-text transition-colors text-[20px]"
                      >logout</span
                    >
                    Logout
                  </button>
                </form>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Toggle the visibility of the main navigation menu
      function toggleMenu() {
        const menu = document.getElementById('main-menu');
        menu.classList.toggle('hidden');
      }

      // Hide the menu when clicking outside of it
      document.addEventListener('click', function (event) {
        const menu = document.getElementById('main-menu');
        const button = event.target.closest('button[onclick="toggleMenu()"]');
        const isMenu = menu.contains(event.target);
        if (!menu.classList.contains('hidden') && !isMenu && !button) {
          menu.classList.add('hidden');
        }
      });
    </script>
  </body>
</html>
